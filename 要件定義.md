Windows 付箋オーバーレイツール 要件定義・技術設計資料 v0.2.0

文書種別: PRD（要件定義）+ Tech Spec（技術仕様）

対象: Windows 11（主）/ .NET デスクトップアプリ

バージョン: v0.2.0（v0.1 + 採用仕様反映）

作成日: 2026-02-06

オーナー: くろだ

想定読者: AI開発者 / 実装担当

1. 定義
1.1 目的

複数ウィンドウで作業するユーザーが「このウィンドウは何をしているか」を忘れないように、画面上に付箋（ラベル）を常時表示する。

1.2 用語

付箋（Note）: 画面上に配置するメモ（リッチテキスト）

非干渉モード: 表示のみ。クリック透過で、他アプリ操作を邪魔しない状態

編集モード: 付箋を編集できる状態（全付箋まとめて編集ON/OFF）

Z順（付箋間）: 付箋同士が重なった際の前後関係（上が前、下が後）

仮想デスクトップ: Windows 11 の Virtual Desktop 機能（Ctrl+Win+←→ 等）

1.3 透明度スケール（採用決定）

UI上のスライダーは 「不透明度（Opacity）」 として扱い、

0 = 完全に透明 / 100 = 完全に不透明 を採用。
これは WPF/Windows の一般的な Opacity 定義（0.0 が透明、1.0 が不透明）に合わせる。

2. 要点（このプロダクトの“絶対ルール”）
2.1 表示レイヤー（最重要）

付箋は 常に「付箋以外の通常ウィンドウ」より前面 に表示される（共通仕様）

付箋どうしの前後は「Z順（付箋間）」で決まる

2.2 ただし “絶対ではない” 例外（採用決定：明記）

フルスクリーン排他（exclusive fullscreen） の上には出せない場合がある（ベストエフォート）

セキュアデスクトップ（UAC など）上では付箋は表示されない（復帰後に再表示）

セキュアデスクトップは OS 側で隔離され、通常プロセスはアクセスできないため

付箋は TopMost を維持するが、他の TopMost と競合した場合の優先は保証しない（ベストエフォート）

HWND_TOPMOST の性質（TopMost で前面維持）

3. スコープ
3.1 v0.2 対象範囲（In scope）

タスクトレイ常駐

自動起動

非干渉/編集モード切替（全付箋一括）

付箋の作成/削除/複製

移動/リサイズ（最小サイズあり）

付箋のリッチテキスト（文字単位の色/サイズ/太字/下線/取り消し線）

背景色（パレット）+ 不透明度（0〜100）

文字色（黒/白 + パレット）

フォント選択 + 許可リスト

マルチモニタ配置の保存/復元（復元ルール強化：識別子 + 相対座標 + ピクセル + クランプ）

Z順（設定画面の D&D 並び替えのみ）

一時非表示トグル（永続化）

グローバルホットキー（編集ON/OFF、無効化可、登録失敗時のエラーUI）

Undo/Redo

実行ログ/診断パッケージ（設定の奥に配置）

仮想デスクトップごとの保持・復元（必須）

3.2 v0.2 範囲外（Out of scope）

（v0.1 の out-of-scope を維持）

エクスポート/インポート、バックアップUI（ただし内部バックアップは実装）

付箋単体の右クリックコンテキストメニュー

特定ウィンドウ追従（付箋をアプリに紐づけて追従）

ネットワーク同期、クラウド同期

4. 要件一覧（Functional Requirements）

ここは「AI開発者がこのままチケット化できる」ように、FR + 受け入れ条件 + 実装メモまで書く。

4.1 起動・常駐（FR-BOOT）
FR-BOOT-1 自動起動（必須）

Windows ログオン時に自動起動する

実装方式: HKCU Run キーに登録（ユーザー権限でOK）

受け入れ条件

Windows 再起動後、アプリが自動起動する

FR-BOOT-2 起動直後の状態（必須）

起動直後は 常に編集OFF（非干渉モード）

前回終了時が編集ONでも復元しない（安全設計）

受け入れ条件

起動直後、付箋はクリック透過で操作を邪魔しない

FR-BOOT-3 タスクトレイ常駐（必須）

常にタスクトレイに常駐し、そこから操作できる

メインウィンドウなし運用を想定（WPF の ShutdownMode は Explicit）

受け入れ条件

付箋がなくてもトレイ操作できる

4.2 トレイメニュー（FR-TRAY）

右クリックメニューで以下を提供：

FR-TRAY-1 編集モード ON/OFF（トグル）

ON: 全付箋クリック可能

OFF: 全付箋クリック透過（非干渉）

FR-TRAY-2 新規付箋作成

1クリックで新規付箋を生成

FR-TRAY-3 一時的に非表示（トグル）

ON: 付箋をすべて非表示

OFF: 付箋を再表示

FR-TRAY-4 設定を開く

設定画面へ遷移

FR-TRAY-5 終了（採用決定）

アプリを即時終了（再起動不要）

終了前に保存を確実に実行（FR-PERSIST と整合）

受け入れ条件

トレイからいつでも終了でき、終了後プロセスが残らない

UI状態表示（採用決定）

非表示ON中: トレイアイコンをグレー化（視認性）
（編集ON表示は付箋UI側で分かるため必須ではない）

4.3 モード仕様（FR-MODE）
FR-MODE-1 非干渉モード（編集OFF）

付箋は表示されるが 完全にクリック不可（クリック透過）

フォーカスを奪わない

実装要点（Windows）

クリック透過: WS_EX_TRANSPARENT（レイヤードウィンドウで mouse hit test を透過）

非アクティブ化: WS_EX_NOACTIVATE（クリックでアクティブ化されない）

TopMost: SetWindowPos(HWND_TOPMOST) 相当で維持

受け入れ条件

付箋上をクリックしても背後アプリが反応する

FR-MODE-2 編集モード（編集ON）

編集ONの間は 全付箋まとめてクリック可能

付箋以外をクリックしても編集OFFに戻さない（明示OFFのみ）

受け入れ条件

編集ON中、付箋を編集でき、OFFに戻すまで維持される

4.4 付箋の編集機能（FR-NOTE）
FR-NOTE-1 作成/削除/複製

新規作成

削除（必須）

複製（必須）

受け入れ条件

削除/複製が編集ONで確実に可能

FR-NOTE-2 移動/リサイズ

ドラッグで移動

角/辺ハンドルで自由リサイズ

最小サイズあり

テキスト自動折り返し

受け入れ条件

最小サイズ以下にならない

リサイズで本文が欠けず折り返す

FR-NOTE-3 付箋内UI（編集ON時のみ）

付箋上部: 装飾ツールバー

付箋下部: 操作アイコン列（最下部配置）

削除（ゴミ箱）

複製（コピーマーク）

採用決定（強）: “選択中の付箋だけ表示”

ツールバー/削除/複製は 選択中の付箋のみ表示

未選択の付箋は本文のみ（視界ノイズ削減）

受け入れ条件

編集ON時、選択中付箋だけUIが見える

編集OFF時、すべての付箋でUIが消える

4.5 テキスト（リッチテキスト）（FR-TEXT）
FR-TEXT-1 文字単位のスタイル（必須）

文字単位で変更可能：

文字色

文字サイズ

太字

取り消し線

下線

FR-TEXT-2 入力方式

ツールバーで適用（簡易）

一般ショートカット併用（Ctrl+B など）

ボタンはホバーでツールチップ（機能名 + ショートカット）

FR-TEXT-3 タイトル欄なし

タイトル専用欄は作らない（本文のみ）

タイトル表現は本文の装飾で行う

FR-TEXT-4 適用ルール（採用決定）

選択範囲あり → 選択範囲に適用

選択範囲なし → カーソル以後の入力に適用（トグル状態保持）

FR-TEXT-5 Undo/Redo（採用決定）

Undo/Redo を提供（Ctrl+Z / Ctrl+Y）

FR-TEXT-6 クリップボード（採用決定）

Ctrl+C / Ctrl+V / Ctrl+X を想定通りに

貼り付け:

リッチで貼れるならリッチ

無理ならプレーンテキストにフォールバック

改行を含む貼り付けで「1行目表示」が更新される

受け入れ条件

同一付箋内で文字単位装飾が保存・復元される

ツールチップが出る

Undo/Redo が効く

実装要点（WPF）

RichTextBox の保存/復元は RTF（DataFormats.Rtf）で実装（要件に合う）

4.6 見た目（FR-STYLE）
FR-STYLE-1 背景

背景色は「カテゴリ別パレット」から選択（例: ビビッド / ナチュラル）

カテゴリ内でベース色選択

不透明度（Opacity） 0〜100（0=透明、100=不透明）

FR-STYLE-2 文字色

黒/白を用意

追加でカラーパレットから選択可能

FR-STYLE-3 編集ON時の操作視認性（採用決定）

編集ON時は、透明度が高い付箋でも操作できるように

最小限の枠線/影を 必ず表示（選択中付箋）

透明で本文が見えにくくてもドラッグ/リサイズ可能にする

受け入れ条件

不透明度が 0〜100 で反映され再起動後も復元

編集ON時に枠/影が確実に見える

4.7 フォント（FR-FONT）
FR-FONT-1 フォント選択（必須）

PC内フォントから選択可能

FR-FONT-2 フォント許可リスト（必須）

初期はデフォルトプリセットのみ表示

設定で許可登録したフォントだけ選択UIに表示

設計決定（仕様明確化）

v0.2 では フォントは「付箋単位」（付箋全体に適用）

文字単位フォントは要件外（複雑化を避ける）

貼り付けで異なるフォントが入ってきた場合は「付箋フォントに正規化」する

受け入れ条件

許可リスト変更が保存され次回起動でも維持

4.8 マルチモニタ（FR-MON）
FR-MON-1 マルチモニタ必須（必須）

モニタごとに配置して保持・復元できる

FR-MON-2 復元ルール強化（採用決定・必須級）

保存時、以下を 二重に保持：

可能なら モニタ識別子（安定ID）

モニタ内相対座標（0〜1）

ピクセル座標（バックアップ）

復元時：

同一モニタが見つかればそこへ復元

見つからなければ プライマリモニタに収める

最後に 必ず画面内にクランプ（見える位置へ補正）

受け入れ条件

別モニタへ移動して保存 → 再起動後も同じモニタ位置に復元

モニタ構成変更時も “見失わない”

実装要点（Windows API）

モニタ列挙: EnumDisplayMonitors

モニタ名: MONITORINFOEX（GetMonitorInfo で取得可能）

より安定した識別: DisplayConfig の monitorDevicePath（デバイスパス）利用

4.9 Z順（付箋間）（FR-ZORDER）
FR-ZORDER-1 調整方法（確定）

設定画面の一覧で D&D 並び替えのみで調整

付箋単体の右クリックメニュー等は作らない

FR-ZORDER-2 UI仕様（確定）

行左にドラッグハンドル「＝」

表示例: ＝ {付箋の1行目テキスト}

上ほど前面、下ほど背面

一覧識別子は 付箋の1行目（先頭行）

空なら「（空）」

長文は末尾省略

FR-ZORDER-3 適用単位（仕様明確化）

仮想デスクトップ単位で Z順を持つ

別デスクトップの付箋同士は重ならないため

受け入れ条件

設定で順番を変えると前後が即時反映される

一覧が1行目で識別できる

実装要点

SetWindowPos で TopMost 内の順序を再構築（挿入順）

4.10 一時的に非表示（FR-HIDE）
FR-HIDE-1 非表示トグル（トレイ）

トレイメニューで全付箋を非表示/再表示

FR-HIDE-2 非表示状態の永続化（確定）

非表示状態は再起動後も維持（起動しても非表示のまま）

FR-HIDE-3 編集ON中に非表示を押した場合（確定）

強制的に編集OFFにして非表示

再表示しても編集はOFFのまま

受け入れ条件

非表示→再起動→起動後も非表示

編集ON中でも非表示で編集OFFになり、再表示してもOFF

4.11 ショートカット（FR-HOTKEY）
FR-HOTKEY-1 編集モード切替（グローバル）

既定: Ctrl + Win + E

設定で変更可能（必須）

無効化（None） も可能（採用決定）

FR-HOTKEY-2 登録失敗時の扱い（採用決定）

RegisterHotKey に失敗したら

設定画面にエラー表示（競合してる可能性等）

別キーに変更できる

無効化できる

根拠（API）

RegisterHotKey / WM_HOTKEY によりグローバルホットキー実装

受け入れ条件

既定キーで切替できる

変更したキーで切替できる

登録失敗が UI に出て復旧できる

4.12 永続化（FR-PERSIST）
FR-PERSIST-1 保存対象（最低限 + 採用強化）

PC再起動後も完全復元（必須）

Noteごとに保存

immutable ID（GUID、採用決定）

内容（RTF）

位置（モニタ情報 + 相対座標 + ピクセル座標）

サイズ

背景（カテゴリ/色/不透明度）

文字装飾（RTF内）

フォント（付箋単位）

全体で保存

Z順（仮想デスクトップ単位）

設定

ホットキー

フォント許可リスト

アプリ状態

起動直後は編集OFF（固定）

非表示状態（維持）

FR-PERSIST-2 保存戦略（採用決定）

変更後 n秒デバウンス保存 + 終了時保存

バックアップ1世代保持

設定ファイル破損時、バックアップから復旧

復旧したことをユーザーへ通知（トースト or 設定画面バナー）

受け入れ条件

任意の見た目/装飾/位置にした後、Windows再起動で一致復元

ファイル破損時に自動復旧でき、ユーザーに分かる

4.13 仮想デスクトップ（Windows 11）（FR-VDSK）※必須
FR-VDSK-1 デスクトップごとに保持（必須）

付箋は 仮想デスクトップ単位で所属する

デスクトップを切り替えると、そのデスクトップ所属の付箋だけ表示される

FR-VDSK-2 永続化（必須）

付箋の所属デスクトップ情報を保存し、再起動後も復元する

FR-VDSK-3 デスクトップ喪失時のフォールバック（必須）

保存されていたデスクトップが存在しない場合

可能なら「Desktop 1」へ移す

それも解決できない場合は “現在デスクトップ” へ移す

いずれも 画面内へクランプ

技術調査メモ（重要）

公式の IVirtualDesktopManager は

「そのウィンドウがどのデスクトップか」判定

「指定GUIDのデスクトップへ移動」
はできる

しかし “デスクトップ一覧の列挙” は公式APIにない ため、実運用では registry を読む手法が知られている

Microsoft PowerToys（公式OSS）も「現在デスクトップID」を registry から読む実装を使っていたが、
“デスクトップが1つの時は値が空になる” など扱いが難しい点を議論している

そのため v0.2 では

ウィンドウ移動は公式 IVirtualDesktopManager を使用

デスクトップ一覧表示や Desktop 1 判定は registry（ベストエフォート）

現在デスクトップのID取得は、短命ウィンドウで GetWindowDesktopId を取る回避策を採用
（Microsoft Q&A でも同様の回避策が提示されている）

受け入れ条件

Desktop A で作った付箋は Desktop A にのみ見える

再起動後も同じデスクトップに復元される

デスクトップ削除/再構成でも付箋を見失わない（フォールバック）

4.14 デバッグ（ログ / 診断）（FR-DEBUG）※採用追加
FR-DEBUG-1 実行ログ

アプリの実行ログをローカルに保存（ローテーションあり）

ログは設定画面の奥に置く（一般ユーザーの視界を汚さない）

FR-DEBUG-2 診断パッケージ生成

「診断パッケージを作成」ボタンで、zip を生成できる

内容:

ログ（最新N本）

設定JSON

OS/アプリバージョン等の環境情報

既定では付箋本文（RTF）を含めない（プライバシー保護）

“本文も含める” は明示チェックで任意（推奨はOFF）

受け入れ条件

ユーザーが zip を送るだけで原因調査の材料になる

5. 比較（実装方式の選択理由）
5.1 UIフレームワーク

採用: WPF（.NET 8 / Windows 専用）

理由:

RichTextBox が要件に合う（RTF保存/復元が現実的）

トレイ常駐、複数ウィンドウ、Win32 interop がやりやすい

5.2 クリック透過の方式

A案: WPF の IsHitTestVisible を OFF

× 透過が完全にならないケースがある（ウィンドウ自体がマウスを掴む）

B案: Win32 の WS_EX_TRANSPARENT を付与（採用）

○ レイヤードウィンドウの hit test を下に流せると明記

5.3 仮想デスクトップ

A案: “デスクトップ切替イベント” を拾って Show/Hide

× EVENT_SYSTEM_DESKTOPSWITCH は virtual desktop の話ではない、という指摘がある

B案: ウィンドウ自体を該当デスクトップへ Move（採用）

○ OSが表示/非表示を担当するので、切替イベントに依存しない

○ 公式APIで移動できる

6. 具体例（仕様がブレやすいところの挙動を確定）
6.1 “非表示ON”中に新規作成

付箋モデルは作成して保存する

ただし表示はしない（非表示が解除されたら、そのデスクトップで表示される）

6.2 編集ON中に非表示を押す

編集OFFに強制変更

全付箋 Hide

再表示しても編集OFFのまま

6.3 2枚が完全に重なりそうなとき

新規作成時・復元時に “完全一致に近い重なり” を検知したら、位置を自動でずらす
（例: +24px,+24px を最大10回、毎回クランプ）

ユーザーが意図的に重ねた場合は許容（ただし裏の選択は Z順調整で）

7. 技術仕様（実装指針）
7.1 全体アーキテクチャ（推奨）
7.1.1 構成

AppHost

トレイ、ホットキー、設定画面管理

NoteManager のライフサイクル管理

NoteManager

Noteモデル管理（CRUD）

NoteWindow 生成/破棄

Z順適用、仮想デスクトップ適用、マルチモニタ復元

Persistence

JSON（設定・メタ）

RTF（本文）

デバウンス保存、バックアップ、破損復旧

Interop

Win32（SetWindowPos, WS_EX_*, RegisterHotKey）

VirtualDesktop（IVirtualDesktopManager）

DisplayConfig（monitorDevicePath）

7.1.2 WPFアプリ設定

ShutdownMode = OnExplicitShutdown（トレイ常駐のため）

DPI awareness: manifest で PerMonitorV2 を推奨（座標ズレ/ボケ回避）

7.2 データモデル
7.2.1 Note（付箋）

NoteId: GUID（不変、採用決定）

RtfPath: string（例: notes/{NoteId}.rtf）

DesktopId: GUID（仮想デスクトップ）

MonitorIdentity:

MonitorDevicePath: string|null（可能なら）

MonitorNameFallback: string|null（MONITORINFOEX.szDevice）

Placement:

RelativeX: double（0..1）

RelativeY: double（0..1）

PixelX: int

PixelY: int

Width: int

Height: int

Style:

BgPaletteCategoryId: string

BgColorId: string

Opacity0to100: int（0..100）

TextColor: (optional default)

FontFamilyName: string

Derived（保存しない）:

FirstLinePreview: string（1行目、Z順リスト表示に使用）

7.2.2 AppSettings

IsHidden: bool（永続）

Hotkey:

Enabled: bool

Modifiers: flags

Key: virtual key

FontAllowList: string[]

Palettes: 定義（将来拡張のためデータ駆動推奨）

ZOrderByDesktop: Dictionary<Guid, List<NoteId>>

7.2.3 保存先

%LocalAppData%\<Company>\<App>\

settings.json

settings.json.bak

notes.json

notes.json.bak

notes\{NoteId}.rtf

logs\app_yyyyMMdd.log

7.3 永続化（実装詳細）
7.3.1 保存方式（atomic + backup）

書き込み:

tmp に書く → File.Replace で本体へ置換（backup を生成）

破損検出:

JSON parse 失敗 → .bak へフォールバック

フォールバック発生時、ユーザーへ通知（トースト or 設定バナー）

7.3.2 デバウンス

変更イベント（テキスト/移動/リサイズ/スタイル/順序）を受けてタイマー開始

n秒間追加変更がなければ保存

終了時は強制フラッシュ

7.4 NoteWindow（付箋ウィンドウ）仕様
7.4.1 Window形状

Borderless（WindowChrome）でリサイズ可能にする

TopMost（SetWindowPos + WPF Topmost）

7.4.2 入力制御（モード切替）

非干渉:

WS_EX_TRANSPARENT ON（クリック透過）

WS_EX_NOACTIVATE ON（フォーカス奪わない）

編集:

WS_EX_TRANSPARENT OFF

WS_EX_NOACTIVATE OFF（編集に必要なら）

7.4.3 UI表示制御

編集ON:

選択中のみツールバー + 下部アイコン

選択中のみ枠/影（常時）

編集OFF:

すべて非表示（本文だけ）

7.4.4 ドラッグ/リサイズ

ドラッグ:

ツールバー背景を “Caption領域” とみなし、そこをドラッグで移動（誤選択防止）

リサイズ:

WindowChrome の ResizeBorderThickness で実現

最小サイズ:

MinWidth/MinHeight を固定値（例 160x120）で設定

7.5 Z順適用アルゴリズム
7.5.1 仕様

ZOrderByDesktop[DesktopId] に NoteId の配列を保持

上が前面

7.5.2 適用

同一 DesktopId のウィンドウのみ対象

後ろ→前の順に SetWindowPos を当てて順序を作る（TopMost を維持）

7.6 仮想デスクトップ（実装詳細）
7.6.1 ウィンドウ移動（公式API）

COM: CLSID_VirtualDesktopManager / IVirtualDesktopManager

使用メソッド:

MoveWindowToDesktop(HWND, GUID)

GetWindowDesktopId(HWND)

IsWindowOnCurrentVirtualDesktop(HWND)

7.6.2 デスクトップ一覧（ベストエフォート）

registry から VirtualDesktopIDs（byte[]）を 16byte ごとに GUID として読む

名前は Desktops{guid}\Name を読む（無ければ Desktop N）

ただし “1個しかないと値が空” 等がありうるので、一覧が取れない場合は Desktop 1 のみ扱い

7.6.3 現在デスクトップIDの取得（安定策）

“短命ウィンドウ” を現在デスクトップに作成し、その HWND の DesktopId を GetWindowDesktopId で取得
（同様の回避策が Microsoft Q&A で提示されている）

これにより registry の “空GUID” 問題を避ける

7.7 マルチモニタ復元（実装詳細）
7.7.1 保存

最終的なウィンドウ矩形を取得

所属モニタを決定

monitorDevicePath（取れれば）と相対座標（work area 基準）と pixel を保存

7.7.2 復元

monitorDevicePath で一致探索（無理なら szDevice）

見つからなければ primary monitor

相対座標→新しい work area へ再投影

最後にクランプ（100%画面内）

7.8 ホットキー（実装詳細）

RegisterHotKey で登録、WM_HOTKEY を受けて EditMode をトグル

失敗時は設定にエラー表示（他アプリが占有など）

無効化可能（Enabled=false）

7.9 自動起動（実装詳細）

HKCU\Software\Microsoft\Windows\CurrentVersion\Run に書き込み

文字列は "C:\path\app.exe" --autostart のようにクォート

7.10 ログ/診断（実装詳細）

ログレベル: Info / Warn / Error

重要イベント:

起動/終了

設定ロード/保存

ノートCRUD

COM失敗（VirtualDesktop）

ホットキー登録失敗

復元時のモニタ不一致・クランプ発動

バックアップ復旧発生

診断zip:

logs/

settings.json / notes.json（必要なら一部マスク）

environment.txt（OSバージョン、DPI、モニタ一覧、デスクトップ一覧取得結果）

8. テスト計画（Acceptance + 重要E2E）
8.1 起動/常駐

Windows再起動 → 自動起動する

起動直後は必ず編集OFF

8.2 非干渉/編集

編集OFF: クリック透過で背後アプリがクリックできる

編集ON: 付箋クリックで編集でき、外クリックしても編集OFFに戻らない

8.3 付箋操作

作成/削除/複製ができる

移動/リサイズができる（最小サイズを割らない）

8.4 見た目

不透明度 0..100 が反映

編集ON時、透明でも枠/影で操作できる

8.5 保存復元

任意状態にして再起動 → 完全一致で復元

設定ファイル破損 → bak から復旧して通知が出る

8.6 マルチモニタ

モニタAに置いて保存 → 再起動後もモニタAに出る

モニタAが無い状態で起動 → primary に収まり、必ず見える位置

8.7 仮想デスクトップ

Desktop 1 に置いた付箋が Desktop 2 で見えない

再起動後も所属デスクトップに復元

Desktop 削除/変更後でも付箋を見失わない（フォールバック）

8.8 例外

フルスクリーン排他上では出ない場合がある（仕様明記どおり）

セキュアデスクトップ（UAC）では表示されない（仕様明記どおり）

9. 参照（実装の根拠リンク集）

くろだくんが「AI開発者にソース元ごと渡す」用途向けに、コピペできる形で載せる（URLはコードブロック内に記載）。

TopMost / Z-order:
- SetWindowPos (HWND_TOPMOST): https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-setwindowpos

クリック透過 / 非アクティブ:
- Window Features (layered + WS_EX_TRANSPARENT): https://learn.microsoft.com/en-us/windows/win32/winmsg/window-features
- Extended Window Styles (WS_EX_NOACTIVATE): https://learn.microsoft.com/en-us/windows/win32/winmsg/extended-window-styles
- The Old New Thing (WS_EX_NOACTIVATE behavior): https://devblogs.microsoft.com/oldnewthing/20240919-00/?p=110283

仮想デスクトップ:
- IVirtualDesktopManager: https://learn.microsoft.com/en-us/windows/win32/api/shobjidl_core/nn-shobjidl_core-ivirtualdesktopmanager
- IsWindowOnCurrentVirtualDesktop: https://learn.microsoft.com/en-us/windows/win32/api/shobjidl_core/nf-shobjidl_core-ivirtualdesktopmanager-iswindowoncurrentvirtualdesktop
- Listing Windows virtual desktops using .NET (registry): https://www.meziantou.net/listing-windows-virtual-desktops-using-dotnet.htm
- PowerToys issue (current desktop id via registry and empty value): https://github.com/microsoft/PowerToys/issues/2160
- Microsoft Q&A workaround (temporary window to get desktop id): https://learn.microsoft.com/en-us/answers/questions/1361084/how-to-find-the-current-virtual-desktop-id

自動起動:
- Run and RunOnce Registry Keys: https://learn.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys

ホットキー:
- RegisterHotKey: https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-registerhotkey
- WM_HOTKEY: https://learn.microsoft.com/en-us/windows/win32/inputdev/wm-hotkey

WPF RichTextBox:
- Save/Load RichTextBox Content: https://learn.microsoft.com/en-us/dotnet/desktop/wpf/controls/how-to-save-load-and-print-richtextbox-content

DPI:
- Setting the default DPI awareness (manifest推奨): https://learn.microsoft.com/en-us/windows/win32/hidpi/setting-the-default-dpi-awareness-for-a-process
- Developing a Per-Monitor DPI-Aware WPF Application: https://learn.microsoft.com/en-us/windows/win32/hidpi/declaring-managed-apps-dpi-aware

モニタ識別:
- EnumDisplayMonitors: https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-enumdisplaymonitors
- MONITORINFOEX: https://learn.microsoft.com/en-us/windows/win32/api/winuser/ns-winuser-monitorinfoexa
- DISPLAYCONFIG_TARGET_DEVICE_NAME (monitorDevicePath): https://learn.microsoft.com/en-us/windows/win32/api/wingdi/ns-wingdi-displayconfig_target_device_name

セキュアデスクトップ:
- How User Account Control works (Only Windows processes can access secure desktop): https://learn.microsoft.